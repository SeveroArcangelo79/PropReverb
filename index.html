<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Verio ‚Äî Modelo de Propagaci√≥n de una Fuente Sonora en 2D</title><link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"><style>:root{--cream-light:#FDF8F3;--cream:#F5EDE4;--cream-dark:#E8DDD0;--sage-light:#C5D4C0;--sage:#9BB08F;--sage-dark:#7A9A6D;--terracotta-light:#D4847C;--terracotta:#B85C50;--terracotta-dark:#8B3A30;--wood-light:#D4B896;--wood:#A67B5B;--wood-dark:#6B4423;--text-primary:#2C2420;--text-secondary:#5C544D;--text-muted:#8A817A;--border:#D4C8BC;--shadow-sm:0 1px 3px rgba(44,36,32,.08);--shadow-md:0 4px 12px rgba(44,36,32,.12);--shadow-lg:0 8px 24px rgba(44,36,32,.16);--radius-sm:6px;--radius-md:10px;--radius-lg:16px;--font-sans:'DM Sans',-apple-system,BlinkMacSystemFont,sans-serif;--font-mono:'JetBrains Mono',monospace}*,*::after,*::before{box-sizing:border-box;margin:0;padding:0}body{font-family:var(--font-sans);background:var(--cream);color:var(--text-primary);font-size:13px;line-height:1.5;height:100vh;display:flex;flex-direction:column;overflow:hidden}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}.app-header{height:50px;background:linear-gradient(135deg,var(--terracotta),var(--terracotta-dark));display:flex;align-items:center;padding:0 16px;gap:8px;position:sticky;top:0;z-index:100;box-shadow:var(--shadow-md);flex-shrink:0}.logo-icon{width:26px;height:26px;background:rgba(255,255,255,.2);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:#fff}.logo-text{font-size:17px;font-weight:700;color:var(--cream-light);letter-spacing:-.3px}.logo-ver{font-size:11px;color:var(--cream-light);opacity:.7;margin-left:2px}.spacer{flex:1}.h-sub{font-size:11px;color:rgba(255,255,255,.5);margin-right:8px}.btn{font-family:var(--font-sans);font-size:11px;font-weight:600;padding:5px 12px;border:0;border-radius:var(--radius-sm);cursor:pointer;display:inline-flex;align-items:center;gap:4px;transition:.2s;white-space:nowrap}.btn-cream{background:var(--cream-light);color:var(--terracotta-dark)}.btn-cream:hover{background:#fff;transform:translateY(-1px);box-shadow:var(--shadow-sm)}.app-layout{display:block;flex:1;min-height:0;padding:18px;overflow-y:auto}.cg{background:#fff;padding:9px 12px;border-radius:var(--radius-md);border:1px solid var(--border);position:relative;overflow:hidden;transition:.2s;margin-bottom:8px}.cg:hover{border-color:var(--sage)}.cl{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;font-size:11px;font-weight:500}.vd{font-family:var(--font-mono);background:var(--cream-light);padding:1px 7px;border-radius:4px;font-size:11px;font-weight:600;color:var(--terracotta)}.pbtn{font-family:var(--font-sans);font-size:11px;font-weight:500;padding:4px 9px;border:1.5px solid var(--border);border-radius:var(--radius-sm);background:#fff;cursor:pointer;transition:.2s;color:var(--text-primary)}.pbtn:hover{border-color:var(--terracotta-light);background:var(--cream)}.pbtn.active{background:linear-gradient(135deg,var(--terracotta),var(--terracotta-dark));color:#fff;border-color:var(--terracotta-dark)}.chk{display:flex;align-items:center;gap:6px;font-size:11px;font-weight:500;cursor:pointer;user-select:none;color:var(--text-secondary);transition:.2s}.chk:hover{color:var(--text-primary)}.chk input{appearance:none;width:14px;height:14px;border:1.5px solid var(--border);border-radius:3px;background:#fff;cursor:pointer;position:relative;transition:.2s;flex-shrink:0}.chk input:checked{border-color:var(--terracotta);background:var(--terracotta)}.chk.c-sage input:checked{background:var(--sage-dark);border-color:var(--sage-dark)}.chk input:checked::after{content:'‚úì';position:absolute;color:#fff;font-size:9px;top:50%;left:50%;transform:translate(-50%,-50%)}input[type=range]{-webkit-appearance:none;width:100%;background:0;margin:2px 0}input[type=range]::-webkit-slider-runnable-track{width:100%;height:5px;cursor:pointer;background:var(--border);border-radius:3px}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;height:15px;width:15px;border-radius:50%;background:var(--terracotta);border:2px solid #fff;box-shadow:var(--shadow-sm);cursor:pointer;margin-top:-5px;transition:transform .15s}input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.15)}input[type=range]::-moz-range-track{width:100%;height:5px;cursor:pointer;background:var(--border);border-radius:3px;border:0}input[type=range]::-moz-range-thumb{height:15px;width:15px;border-radius:50%;background:var(--terracotta);border:2px solid #fff;box-shadow:var(--shadow-sm);cursor:pointer}.sl-sage::-moz-range-thumb,.sl-sage::-webkit-slider-thumb{background:var(--sage-dark)}.sl-dark::-moz-range-thumb,.sl-dark::-webkit-slider-thumb{background:var(--terracotta-dark)}.sl-wood::-moz-range-thumb,.sl-wood::-webkit-slider-thumb{background:var(--wood)}.ray-container{display:flex;gap:16px;height:100%}.ray-canvas-wrap{flex:1;background:#fff;border-radius:var(--radius-lg);border:1px solid var(--border);box-shadow:var(--shadow-md);overflow:hidden;position:relative}.ray-canvas-wrap canvas{width:100%;height:100%;display:block}.ray-controls{width:280px;display:flex;flex-direction:column;gap:8px;overflow-y:auto}.ray-info{background:#fff;border:1px solid var(--border);border-radius:var(--radius-md);padding:12px;font-size:11px;color:var(--text-secondary);line-height:1.6;box-shadow:var(--shadow-sm)}.ray-info strong{color:var(--text-primary)}.ray-stats{font-family:var(--font-mono);font-size:10px;background:var(--cream-light);padding:8px;border-radius:var(--radius-sm);margin-top:6px;line-height:1.6}.ray-energy-bar{height:4px;background:var(--cream-dark);border-radius:2px;overflow:hidden;margin-top:4px}.ray-energy-fill{height:100%;border-radius:2px;transition:width .1s}@media(max-width:900px){.ray-container{flex-direction:column}}</style></head><body><header class="app-header"><div class="logo-icon">V</div><span class="logo-text">Verio</span> <span class="logo-ver">Modelo de Propagaci√≥n de una Fuente Sonora</span><div class="spacer"></div><span class="h-sub">ATENCI√ìN: Simplificaci√≥n Did√°ctica</span></header><div class="app-layout"><div class="ray-container"><div class="ray-canvas-wrap"><canvas id="rayCanvas"></canvas></div><div class="ray-controls"><div class="ray-info"><strong>Trazado de Propagaci√≥n 2D</strong><br>Representaci√≥n del camino libre medio (MFP) y reflexiones sucesivas en planta. Cada relfexion disipa energ√≠a seg√∫n Œ± de las superficies.<div class="ray-stats" id="rayStats">Incidencias: 1 | Reflexiones: 0<br>Energ√≠a promedio: 100%</div><div class="ray-energy-bar"><div class="ray-energy-fill" id="rayEnergyFill" style="width:100%;background:var(--sage)"></div></div></div><div class="cg"><div class="cl"><span>Cantidad de Incidencias</span><span id="val-rayCount" class="vd">1</span></div><input type="range" id="rayCount" min="1" max="72" step="1" value="1"><div style="display:flex;justify-content:space-between;font-size:9px;color:var(--text-muted);margin-top:2px"><span>1</span><span>72</span></div></div><div class="cg" id="angleControl"><div class="cl"><span>√Ångulo de Propagaci√≥n</span><span id="val-rayAngle" class="vd">45¬∞</span></div><input type="range" id="rayAngle" min="0" max="359" step="1" value="45" class="sl-wood"><div style="display:flex;justify-content:space-between;font-size:9px;color:var(--text-muted);margin-top:2px"><span>0¬∞</span><span>359¬∞</span></div></div><div class="cg" id="distControl" style="display:none"><div class="cl"><span>Distribuci√≥n</span><span id="val-rayDist" class="vd">Uniforme</span></div><div style="display:flex;gap:4px;margin-top:4px"><button class="pbtn active" id="distUniform" onclick="sD('uniform')">Uniforme</button> <button class="pbtn" id="distRandom" onclick="sD('random')">Aleatoria</button> <button class="pbtn" id="distHemi" onclick="sD('hemi')">Hemisf√©rica</button></div></div><div class="cg"><div class="cl"><span>Coef. de Absorci√≥n (Œ±)</span><span id="val-rayAlpha" class="vd">0.15</span></div><input type="range" id="rayAlpha" min="0.02" max="0.80" step="0.01" value="0.15" class="sl-sage"></div><div class="cg"><div class="cl"><span>Velocidad de la Animaci√≥n</span><span id="val-raySpeed" class="vd">1.0√ó</span></div><input type="range" id="raySpeed" min="0.2" max="3.0" step="0.1" value="1.0" class="sl-wood"></div><div class="cg"><div class="cl"><span>M√°x. Reflexiones</span><span id="val-rayMaxB" class="vd">80</span></div><input type="range" id="rayMaxBounces" min="10" max="200" step="5" value="80" class="sl-dark"></div><label class="chk c-sage" style="padding:4px 0"><input type="checkbox" id="rayHeatmap"> Mostrar mapa de energ√≠a</label><button class="btn btn-cream" style="width:100%;justify-content:center;padding:10px" onclick="rR()">üîÑ Nueva Experiencia</button> <button class="btn btn-cream" style="width:100%;justify-content:center;padding:10px;margin-top:8px" onclick="tA()"><span id="rayPlayLabel">‚ñ∂ Iniciar</span></button></div></div></div><script>const D=document,E=e=>D.getElementById(e),M=Math,Mc=M.cos,Ms=M.sin,Mp=M.PI,Mx=M.max,Mi=M.min;let rA=!1,rF=null,rS=[],rL=.15,rP=1,rM=80,rD="uniform",rH=null;const C=E("rayCanvas"),X=C.getContext("2d"),RC=[[184,92,80],[122,154,109],[166,123,91],[139,58,48],[155,176,143],[212,132,124],[107,68,35],[197,212,192],[180,140,100],[200,80,70],[100,160,90],[170,100,70]];function iR(){E("rayAlpha").oninput=e=>{rL=+e.target.value;E("val-rayAlpha").textContent=rL.toFixed(2)};E("raySpeed").oninput=e=>{rP=+e.target.value;E("val-raySpeed").textContent=rP.toFixed(1)+"√ó"};E("rayMaxBounces").oninput=e=>{rM=+e.target.value;E("val-rayMaxB").textContent=rM};E("rayCount").oninput=e=>{let t=+e.target.value;E("val-rayCount").textContent=t,E("angleControl").style.display=1===t?"block":"none",E("distControl").style.display=t>1?"block":"none",E("val-rayDist").textContent="uniform"===rD?"Uniforme":"random"===rD?"Aleatoria":"Hemisf√©rica"};E("rayAngle").oninput=e=>{E("val-rayAngle").textContent=e.target.value+"¬∞"};E("rayHeatmap").onchange=e=>{e.target.checked&&!rH&&iH(),!e.target.checked&&(rH=null)};window.addEventListener("resize",iC)}function sD(e){rD=e;D.querySelectorAll("#distControl .pbtn").forEach(e=>e.classList.remove("active"));E("dist"+e.charAt(0).toUpperCase()+e.slice(1)).classList.add("active");E("val-rayDist").textContent="uniform"===e?"Uniforme":"random"===e?"Aleatoria":"Hemisf√©rica"}function iC(){let e=C.parentElement;C.width=e.clientWidth,C.height=e.clientHeight,0===rS.length?rR():dF()}function iH(){let e=C.width,t=C.height,a=M.ceil(e/10),r=M.ceil(t/10);rH=Array.from({length:r},()=>new Float32Array(a))}function rR(){let e=C.width||600,t=C.height||400,a=60,r=40,n=e-120,l=t-80,i=a+n/2,c=r+l/2,o=+E("rayCount").value;if(rS=[],E("rayHeatmap").checked&&iH(),1===o){let d=+E("rayAngle").value,u=d*Mp/180;rS.push({x:i,y:c,dx:3*Mc(u),dy:3*Ms(u),energy:1,trail:[{x:i,y:c}],bounces:0,color:RC[0],active:!0})}else for(let m=0;m<o;m++){let f;f="uniform"===rD?m/o*Mp*2:"hemi"===rD?-Mp/2+m/(o-1||1)*Mp:M.random()*Mp*2;rS.push({x:i,y:c,dx:3*Mc(f),dy:3*Ms(f),energy:1,trail:[{x:i,y:c}],bounces:0,color:RC[m%RC.length],active:!0})}uS(),dF()}function uS(){let e=rS.reduce((e,t)=>e+t.bounces,0),t=rS.reduce((e,t)=>e+t.energy,0)/rS.length,a=rS.filter(e=>e.active).length;E("rayStats").innerHTML=`Incidencias: ${rS.length} (${a} activas)<br>Reflexiones totales: ${e}<br>Energ√≠a promedio: ${(100*t).toFixed(1)}%`;let r=E("rayEnergyFill");r.style.width=100*t+"%",r.style.background=t>.5?"var(--sage)":t>.2?"var(--wood)":"var(--terracotta)"}function tA(){rA=!rA,E("rayPlayLabel").textContent=rA?"‚ñ† Detener":"‚ñ∂ Iniciar",rA?aR():cancelAnimationFrame(rF)}function aR(){if(!rA)return;let e=C.width,t=C.height,a=60,r=40,n=e-120,l=t-80;rS.forEach(e=>{if(!e.active||e.energy<.001||e.bounces>=rM)return e.active=!1;e.x+=e.dx*rP,e.y+=e.dy*rP,e.x<=a||e.x>=a+n?(e.dx*=-1,e.x=Mx(a+.5,Mi(a+n-.5,e.x)),e.energy*=1-rL,e.bounces++):void 0,e.y<=r||e.y>=r+l?(e.dy*=-1,e.y=Mx(r+.5,Mi(r+l-.5,e.y)),e.energy*=1-rL,e.bounces++):void 0,e.trail.push({x:e.x,y:e.y}),e.trail.length>800&&e.trail.shift();if(rH){let c=0|e.x/10,o=0|e.y/10;o>=0&&o<rH.length&&c>=0&&c<rH[0].length&&(rH[o][c]+=e.energy*.02)}}),uS(),dF(),rS.some(e=>e.active)?rF=requestAnimationFrame(aR):(rA=!1,E("rayPlayLabel").textContent="‚ñ∂ Iniciar")}function dF(){let e=C.width,t=C.height,a=60,r=40,n=e-120,l=t-80;if(X.fillStyle="#FFF",X.fillRect(0,0,e,t),rH&&E("rayHeatmap").checked){let i=0;for(let c of rH)for(let o of c)o>i&&(i=o);if(i>0)for(let d=0;d<rH.length;d++)for(let u=0;u<rH[0].length;u++){let m=rH[d][u]/i;if(m>.01){let f=10*u,x=10*d;f>=a&&f<=a+n&&x>=r&&x<=r+l&&(X.fillStyle=`hsla(${240-240*m},80%,50%,${Mi(.6*m,.4)})`,X.fillRect(f,x,10,10))}}}X.strokeStyle="#2C2420",X.lineWidth=2.5,X.strokeRect(a,r,n,l),X.font="500 10px 'DM Sans'",X.fillStyle="#8A817A",X.textAlign="center";let y=`Œ± = ${rL.toFixed(2)}`;X.fillText(y,a+n/2,r-8),X.save(),X.translate(a-16,r+l/2),X.rotate(-Mp/2),X.fillText(y,0,0),X.restore(),X.save(),X.translate(a+n+16,r+l/2),X.rotate(Mp/2),X.fillText(y,0,0),X.restore(),X.fillText(y,a+n/2,r+l+16);let h=a+n/2,F=r+l/2;X.beginPath(),X.arc(h,F,6,0,2*Mp),X.fillStyle="rgba(184,92,80,.15)",X.fill(),X.beginPath(),X.arc(h,F,3,0,2*Mp),X.fillStyle="#B85C50",X.fill(),X.font="600 10px 'DM Sans'",X.fillStyle="#B85C50",X.textAlign="left",X.fillText("Fuente Sonora",h+10,F-2),rS.forEach(e=>{if(e.trail.length<2)return;let[t,a,r]=e.color;for(let n=1;n<e.trail.length;n++){let l=n/e.trail.length;X.strokeStyle=`rgba(${t},${a},${r},${.03+.45*l})`,X.lineWidth=.5+1.5*l,X.beginPath(),X.moveTo(e.trail[n-1].x,e.trail[n-1].y),X.lineTo(e.trail[n].x,e.trail[n].y),X.stroke()}e.active&&(X.beginPath(),X.arc(e.x,e.y,2+3*e.energy,0,2*Mp),X.fillStyle=`rgba(${t},${a},${r},${.4+.6*e.energy})`,X.fill())});if(1===rS.length&&0===rS[0].bounces&&!rA){let p=+E("rayAngle").value,b=p*Mp/180;X.save(),X.strokeStyle="rgba(184,92,80,.4)",X.lineWidth=1.5,X.setLineDash([4,3]),X.beginPath(),X.moveTo(h,F),X.lineTo(h+Mc(b)*60,F+Ms(b)*60),X.stroke();let M=h+Mc(b)*60,C=F+Ms(b)*60;X.setLineDash([]),X.beginPath(),X.moveTo(M,C),X.lineTo(M-8*Mc(b-.4),C-8*Ms(b-.4)),X.moveTo(M,C),X.lineTo(M-8*Mc(b+.4),C-8*Ms(b+.4)),X.stroke(),X.font="600 10px 'JetBrains Mono'",X.fillStyle="rgba(184,92,80,.6)",X.textAlign="left",X.fillText(p+"¬∞",M+8,C+4),X.restore()}X.font="500 9px 'JetBrains Mono'",X.fillStyle="#8A817A",X.textAlign="left",X.fillText(`${(n/140).toFixed(1)}m √ó ${(l/165).toFixed(1)}m`,a,r+l+30),X.textAlign="right",X.fillText(`M√°x. Reflexiones: ${rM}`,a+n,r+l+30)}window.sD=sD,window.rR=rR,window.tA=tA,iR(),iC();</script></body></html>